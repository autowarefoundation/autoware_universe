<launch>
  <arg name="input_topic_name" default="/sensing/lidar/top/pointcloud_raw"/>
  <arg name="output_topic_name" default="/sensing/lidar/top/voxel_grid_downsample_filter/pointcloud"/>
  <arg name="input_frame" default="base_link"/>
  <arg name="output_frame" default="base_link"/>
  <arg name="voxel_grid_downsample_filter_param_file" default="$(find-pkg-share autoware_pointcloud_preprocessor)/config/voxel_grid_downsample_filter_node.param.yaml"/>
  <arg name="container_name" default="" description="Container name for composable node. If empty, standalone node is launched."/>

  <!-- Standalone mode: launch as a regular node when container_name is empty -->
  <node pkg="autoware_pointcloud_preprocessor" exec="voxel_grid_downsample_filter_node" name="voxel_grid_downsample_filter_node" if="$(eval &quot;'$(var container_name)'==''&quot;)">
    <param from="$(var voxel_grid_downsample_filter_param_file)"/>
    <remap from="input" to="$(var input_topic_name)"/>
    <remap from="output" to="$(var output_topic_name)"/>
    <param name="input_frame" value="$(var input_frame)"/>
    <param name="output_frame" value="$(var output_frame)"/>
  </node>

  <!-- Composable mode: load into existing container when container_name is specified -->
  <load_composable_node target="$(var container_name)" if="$(eval &quot;'$(var container_name)'!=''&quot;)">
    <composable_node pkg="autoware_pointcloud_preprocessor" plugin="autoware::pointcloud_preprocessor::VoxelGridDownsampleFilterComponent" name="voxel_grid_downsample_filter_node" namespace="">
      <param from="$(var voxel_grid_downsample_filter_param_file)"/>
      <remap from="input" to="$(var input_topic_name)"/>
      <remap from="output" to="$(var output_topic_name)"/>
      <param name="input_frame" value="$(var input_frame)"/>
      <param name="output_frame" value="$(var output_frame)"/>
    </composable_node>
  </load_composable_node>
</launch>
